MPAP2

%===================================================================================================

BEGIN HBSPLINECUTFEM 1


dimensions
! ndf ndm
  3   2


origin
!  X0   Y0   Z0
 -15.0  -15.0  0.0


grid dimensions
! lx     ly    lz
  55.0   30.0    1.0


polynomial degrees
!  p   q   r
   1   1   0


number of elements
!  nx   ny   nz
  148   91   0


fluid properties
! nGP flag  axsy     rho      mu    fx    fy    fz    tauSUPG      tauPSPG  tauLSIC     eps     gamm
   2    0    0       1.0     0.005   0.0   0.0  0.0      1.0         1.0       0.0       0.0    0.0


refinement type
! type nref
   5    2    1


mesh refinement limits
! refinement further downstream
! 1  -5.0   20.0    -6.5    6.5
! 2  -4.0   18.0    -5.5    5.5
! 3  -3.0   17.0    -4.5    4.5
! 4  -2.0   16.0    -3.5    3.5

! localised refinement
 1  -5.0    24.0    -6.5    6.5
 2  -4.0    20.0    -5.5    5.5
 3  -3.0    8.0    -4.5    4.5
 4  -2.0    7.0    -3.5    3.5
 5  -1.5    6.0    -3.0    3.0


dirichlet boundary conditions
 1  1  1.0  1.0e2  1  -1.0
 1  2  0.0  1.0e2  1  -1.0
 3  2  0.0  1.0e2  1  -1.0
 4  2  0.0  1.0e2  1  -1.0


!derivative boundary conditions
! 2  1  0.0  1.0e2
! 2  2  0.0  1.0e2


staggered or monolithic
0  2  0.4  0.0  0.0


cutfem parameters
! gp_type  nGPbound  nGPcell  refLev1   refLev2  tmp2  gammU    gammP
    1         3         3        4         0      1     0.02    0.02




immersed body data
! R/F  P/L  penalty  Nitsche  NitscheFact
   0    0    1.0e2      1      -1.0


immersed points
1 	   0.00000000 	   0.08333333
2 	   0.02042428 	   0.08326378
3 	   0.04084808 	   0.08305477
4 	   0.06127091 	   0.08270528
5 	   0.08169227 	   0.08221354
6 	   0.10211161 	   0.08157703
7 	   0.12252835 	   0.08079240
8 	   0.14294186 	   0.07985536
9 	   0.16335141 	   0.07876059
10 	   0.18375619 	   0.07750155
11 	   0.20415525 	   0.07607026
12 	   0.22454747 	   0.07445700
13 	   0.24493149 	   0.07264995
14 	   0.26530568 	   0.07063460
15 	   0.28566795 	   0.06839303
16 	   0.30601565 	   0.06590280
17 	   0.32634530 	   0.06313538
18 	   0.34665214 	   0.06005375
19 	   0.36692949 	   0.05660849
20 	   0.38716747 	   0.05273133
21 	   0.40735053 	   0.04832343
22 	   0.42745217 	   0.04323214
23 	   0.44742133 	   0.03719847
24 	   0.46713879 	   0.02971221
25 	   0.48619792 	   0.01944478
26 	   0.50000000 	   0.00000000
27 	   0.48619792 	  -0.01944478
28 	   0.46713879 	  -0.02971221
29 	   0.44742133 	  -0.03719847
30 	   0.42745217 	  -0.04323214
31 	   0.40735053 	  -0.04832343
32 	   0.38716747 	  -0.05273133
33 	   0.36692949 	  -0.05660849
34 	   0.34665214 	  -0.06005375
35 	   0.32634530 	  -0.06313538
36 	   0.30601565 	  -0.06590280
37 	   0.28566795 	  -0.06839303
38 	   0.26530568 	  -0.07063460
39 	   0.24493149 	  -0.07264995
40 	   0.22454747 	  -0.07445700
41 	   0.20415525 	  -0.07607026
42 	   0.18375619 	  -0.07750155
43 	   0.16335141 	  -0.07876059
44 	   0.14294186 	  -0.07985536
45 	   0.12252835 	  -0.08079240
46 	   0.10211161 	  -0.08157703
47 	   0.08169227 	  -0.08221354
48 	   0.06127091 	  -0.08270528
49 	   0.04084808 	  -0.08305477
50 	   0.02042428 	  -0.08326378
51 	   0.00000000 	  -0.08333333
52 	  -0.02042428 	  -0.08326378
53 	  -0.04084808 	  -0.08305477
54 	  -0.06127091 	  -0.08270528
55 	  -0.08169227 	  -0.08221354
56 	  -0.10211161 	  -0.08157703
57 	  -0.12252835 	  -0.08079240
58 	  -0.14294186 	  -0.07985536
59 	  -0.16335141 	  -0.07876059
60 	  -0.18375619 	  -0.07750155
61 	  -0.20415525 	  -0.07607026
62 	  -0.22454747 	  -0.07445700
63 	  -0.24493149 	  -0.07264995
64 	  -0.26530568 	  -0.07063460
65 	  -0.28566795 	  -0.06839303
66 	  -0.30601565 	  -0.06590280
67 	  -0.32634530 	  -0.06313538
68 	  -0.34665214 	  -0.06005375
69 	  -0.36692949 	  -0.05660849
70 	  -0.38716747 	  -0.05273133
71 	  -0.40735053 	  -0.04832343
72 	  -0.42745217 	  -0.04323214
73 	  -0.44742133 	  -0.03719847
74 	  -0.46713879 	  -0.02971221
75 	  -0.48619792 	  -0.01944478
76 	  -0.50000000 	  -0.00000000
77 	  -0.48619792 	   0.01944478
78 	  -0.46713879 	   0.02971221
79 	  -0.44742133 	   0.03719847
80 	  -0.42745217 	   0.04323214
81 	  -0.40735053 	   0.04832343
82 	  -0.38716747 	   0.05273133
83 	  -0.36692949 	   0.05660849
84 	  -0.34665214 	   0.06005375
85 	  -0.32634530 	   0.06313538
86 	  -0.30601565 	   0.06590280
87 	  -0.28566795 	   0.06839303
88 	  -0.26530568 	   0.07063460
89 	  -0.24493149 	   0.07264995
90 	  -0.22454747 	   0.07445700
91 	  -0.20415525 	   0.07607026
92 	  -0.18375619 	   0.07750155
93 	  -0.16335141 	   0.07876059
94 	  -0.14294186 	   0.07985536
95 	  -0.12252835 	   0.08079240
96 	  -0.10211161 	   0.08157703
97 	  -0.08169227 	   0.08221354
98 	  -0.06127091 	   0.08270528
99 	  -0.04084808 	   0.08305477
100 	  -0.02042428 	   0.08326378


immersed integration elements
1	1	1	2
2	1	2	3
3	1	3	4
4	1	4	5
5	1	5	6
6	1	6	7
7	1	7	8
8	1	8	9
9	1	9	10
10	1	10	11
11	1	11	12
12	1	12	13
13	1	13	14
14	1	14	15
15	1	15	16
16	1	16	17
17	1	17	18
18	1	18	19
19	1	19	20
20	1	20	21
21	1	21	22
22	1	22	23
23	1	23	24
24	1	24	25
25	1	25	26
26	1	26	27
27	1	27	28
28	1	28	29
29	1	29	30
30	1	30	31
31	1	31	32
32	1	32	33
33	1	33	34
34	1	34	35
35	1	35	36
36	1	36	37
37	1	37	38
38	1	38	39
39	1	39	40
40	1	40	41
41	1	41	42
42	1	42	43
43	1	43	44
44	1	44	45
45	1	45	46
46	1	46	47
47	1	47	48
48	1	48	49
49	1	49	50
50	1	50	51
51	1	51	52
52	1	52	53
53	1	53	54
54	1	54	55
55	1	55	56
56	1	56	57
57	1	57	58
58	1	58	59
59	1	59	60
60	1	60	61
61	1	61	62
62	1	62	63
63	1	63	64
64	1	64	65
65	1	65	66
66	1	66	67
67	1	67	68
68	1	68	69
69	1	69	70
70	1	70	71
71	1	71	72
72	1	72	73
73	1	73	74
74	1	74	75
75	1	75	76
76	1	76	77
77	1	77	78
78	1	78	79
79	1	79	80
80	1	80	81
81	1	81	82
82	1	82	83
83	1	83	84
84	1	84	85
85	1	85	86
86	1	86	87
87	1	87	88
88	1	88	89
89	1	89	90
90	1	90	91
91	1	91	92
92	1	92	93
93	1	93	94
94	1	94	95
95	1	95	96
96	1	96	97
97	1	97	98
98	1	98	99
99	1	99	100
100	1	100	  1



rigid body mass
!   Mxx   Mxy  Mxt  Myx   Myy   Myt  Mtx  Mty  Mtt
  2.61799387799149  0.0  0.0  0.0  2.61799387799149  0.0  0.0  0.0  0.0


rigid body damping
!   Cxx   Cxy  Cxt  Cyx    Cyy    Cyt  Ctx  Cty  Ctt
  0.261799387799149  0.0  0.0  0.0  0.261799387799149  0.0  0.0  0.0  0.0


rigid body stiffness
!   Kxx   Kxy  Kxt  Kyx    Kyy    Kyt  Ktx  Kty  Ktt
  4.13417022403998  0.0  0.0  0.0  4.13417022403998  0.0  0.0  0.0  0.0


rigid body degree of freedom
! d1   d2   d3
 -1    1   -1


rigid body prescribed motion
! f(t) = p1 + p2*t + p3*sin(p4*t+p5) + p6*cos(p7*t+p8)
! dof  t0     t1     p1    p2    p3                 p4                 p5    p6    p7    p8
  3    0.0  1000.0   0.0   0.0   1.57079632679490   1.13097335529233   0.0   0.0   0.0   0.0  




immersed body output
! type  nodenum  dof
   1       1      1 
   1       1      2 
   1       1      3 
   3       1      1 
   3       1      2 
   3       1      3
   4       1      1 
   4       1      2 
   4       1      3
   5       1      1 
   5       1      2 
   5       1      3




immersed body data
! R/F  P/L  penalty  Nitsche  NitscheFact
   0    0    1.0e2      1      -1.0


immersed points
1	3.00000000	0.08333333
2	3.02042428	0.08326378
3	3.04084808	0.08305477
4	3.06127091	0.08270528
5	3.08169227	0.08221354
6	3.10211161	0.08157703
7	3.12252835	0.08079240
8	3.14294186	0.07985536
9	3.16335141	0.07876059
10	3.18375619	0.07750155
11	3.20415525	0.07607026
12	3.22454747	0.07445700
13	3.24493149	0.07264995
14	3.26530568	0.07063460
15	3.28566795	0.06839303
16	3.30601565	0.06590280
17	3.32634530	0.06313538
18	3.34665214	0.06005375
19	3.36692949	0.05660849
20	3.38716747	0.05273133
21	3.40735053	0.04832343
22	3.42745217	0.04323214
23	3.44742133	0.03719847
24	3.46713879	0.02971221
25	3.48619792	0.01944478
26	3.50000000	0.00000000
27	3.48619792	-0.01944478
28	3.46713879	-0.02971221
29	3.44742133	-0.03719847
30	3.42745217	-0.04323214
31	3.40735053	-0.04832343
32	3.38716747	-0.05273133
33	3.36692949	-0.05660849
34	3.34665214	-0.06005375
35	3.32634530	-0.06313538
36	3.30601565	-0.06590280
37	3.28566795	-0.06839303
38	3.26530568	-0.07063460
39	3.24493149	-0.07264995
40	3.22454747	-0.07445700
41	3.20415525	-0.07607026
42	3.18375619	-0.07750155
43	3.16335141	-0.07876059
44	3.14294186	-0.07985536
45	3.12252835	-0.08079240
46	3.10211161	-0.08157703
47	3.08169227	-0.08221354
48	3.06127091	-0.08270528
49	3.04084808	-0.08305477
50	3.02042428	-0.08326378
51	3.00000000	-0.08333333
52	2.97957572	-0.08326378
53	2.95915192	-0.08305477
54	2.93872909	-0.08270528
55	2.91830773	-0.08221354
56	2.89788839	-0.08157703
57	2.87747165	-0.08079240
58	2.85705814	-0.07985536
59	2.83664859	-0.07876059
60	2.81624381	-0.07750155
61	2.79584475	-0.07607026
62	2.77545253	-0.07445700
63	2.75506851	-0.07264995
64	2.73469432	-0.07063460
65	2.71433205	-0.06839303
66	2.69398435	-0.06590280
67	2.67365470	-0.06313538
68	2.65334786	-0.06005375
69	2.63307051	-0.05660849
70	2.61283253	-0.05273133
71	2.59264947	-0.04832343
72	2.57254783	-0.04323214
73	2.55257867	-0.03719847
74	2.53286121	-0.02971221
75	2.51380208	-0.01944478
76	2.50000000	0.00000000
77	2.51380208	0.01944478
78	2.53286121	0.02971221
79	2.55257867	0.03719847
80	2.57254783	0.04323214
81	2.59264947	0.04832343
82	2.61283253	0.05273133
83	2.63307051	0.05660849
84	2.65334786	0.06005375
85	2.67365470	0.06313538
86	2.69398435	0.06590280
87	2.71433205	0.06839303
88	2.73469432	0.07063460
89	2.75506851	0.07264995
90	2.77545253	0.07445700
91	2.79584475	0.07607026
92	2.81624381	0.07750155
93	2.83664859	0.07876059
94	2.85705814	0.07985536
95	2.87747165	0.08079240
96	2.89788839	0.08157703
97	2.91830773	0.08221354
98	2.93872909	0.08270528
99	2.95915192	0.08305477
100	2.97957572	0.08326378



immersed integration elements
1	1	1	2
2	1	2	3
3	1	3	4
4	1	4	5
5	1	5	6
6	1	6	7
7	1	7	8
8	1	8	9
9	1	9	10
10	1	10	11
11	1	11	12
12	1	12	13
13	1	13	14
14	1	14	15
15	1	15	16
16	1	16	17
17	1	17	18
18	1	18	19
19	1	19	20
20	1	20	21
21	1	21	22
22	1	22	23
23	1	23	24
24	1	24	25
25	1	25	26
26	1	26	27
27	1	27	28
28	1	28	29
29	1	29	30
30	1	30	31
31	1	31	32
32	1	32	33
33	1	33	34
34	1	34	35
35	1	35	36
36	1	36	37
37	1	37	38
38	1	38	39
39	1	39	40
40	1	40	41
41	1	41	42
42	1	42	43
43	1	43	44
44	1	44	45
45	1	45	46
46	1	46	47
47	1	47	48
48	1	48	49
49	1	49	50
50	1	50	51
51	1	51	52
52	1	52	53
53	1	53	54
54	1	54	55
55	1	55	56
56	1	56	57
57	1	57	58
58	1	58	59
59	1	59	60
60	1	60	61
61	1	61	62
62	1	62	63
63	1	63	64
64	1	64	65
65	1	65	66
66	1	66	67
67	1	67	68
68	1	68	69
69	1	69	70
70	1	70	71
71	1	71	72
72	1	72	73
73	1	73	74
74	1	74	75
75	1	75	76
76	1	76	77
77	1	77	78
78	1	78	79
79	1	79	80
80	1	80	81
81	1	81	82
82	1	82	83
83	1	83	84
84	1	84	85
85	1	85	86
86	1	86	87
87	1	87	88
88	1	88	89
89	1	89	90
90	1	90	91
91	1	91	92
92	1	92	93
93	1	93	94
94	1	94	95
95	1	95	96
96	1	96	97
97	1	97	98
98	1	98	99
99	1	99	100
100	1	100	  1


rigid body mass
!   Mxx   Mxy  Mxt  Myx   Myy   Myt  Mtx  Mty  Mtt
  2.61799387799149  0.0  0.0  0.0  2.61799387799149  0.0  0.0  0.0  0.0


rigid body damping
!   Cxx   Cxy  Cxt  Cyx    Cyy    Cyt  Ctx  Cty  Ctt
  0.261799387799149  0.0  0.0  0.0  0.261799387799149  0.0  0.0  0.0  0.0


rigid body stiffness
!   Kxx   Kxy  Kxt  Kyx    Kyy    Kyt  Ktx  Kty  Ktt
  4.13417022403998  0.0  0.0  0.0  4.13417022403998  0.0  0.0  0.0  0.0


rigid body degree of freedom
! d1   d2   d3
 -1    1   -1


rigid body prescribed motion
! f(t) = p1 + p2*t + p3*sin(p4*t+p5) + p6*cos(p7*t+p8)
! dof  t0     t1     p1    p2    p3                 p4                 p5    p6    p7    p8
  3    0.0  1000.0   0.0   0.0   1.57079632679490   1.13097335529233   0.0   0.0   0.0   0.0  




immersed body output
! type  nodenum  dof
   1       1      1 
   1       1      2 
   1       1      3 
   3       1      1 
   3       1      2 
   3       1      3
   4       1      1 
   4       1      2 
   4       1      3
   5       1      1 
   5       1      2 
   5       1      3



control parameters
!  tol     tis   tis_param
 1.0e-6     4      0.0




END HBSPLINECUTFEM 1



BEGIN TIME_FUNCTIONS
!
! lam(t) = p1 + p2*t + p3*sin(p4*t+p5) + p6*cos(p7*t+p8)
!
! id  t0    t1      p1    p2    p3    p4    p5     p6   p7    p8

  1  0.0  10000.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0

!  1  0.0      1.0   0.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0
!  1  1.0  10000.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0



END TIME_FUNCTIONS

%===================================================================================================



BEGIN RUN_CONTROL



BATCH
anly,solv,,28,1,8,1,1,1,1            ! this sets the solver
chen,data,,28,2,2,2,1                ! this generates the grid file, without any solution field.
vtk,flow,,28,1,1,1,1,1,1,1,0,0,1     ! this generates the grid file, with the solution field. Since we have not solved anything, all the values are zero.
dt,,0.02                             ! time step size
wrnd                                 ! write nodal data to the output file starting with T
wait,mous                            ! useful to stop the program before running the time loop if we want to check if the input geometries are correct.
loop,,49.9999999999,2                ! Time loop; this particular one runs up to a final time of 500 seconds. 49.999999999 to avoid floating point issues.
  !wait,mous                         ! to stop and check if things are going fine with the solution at each time step. Remove ! to execute this line.
  time                               ! update time functions
  updt                               ! update the solver. this step solves the solid problem, if active, updates the fluid mesh and sets all the relevant fields.
  anly,tang,,28,1,1                  ! this step solves the fluid problem
  vtk,flow,,28,1,1,1,1,1,1,1,0,0,1   ! generates output in the VTK format. One for each time step. To generate one file for every 10th step use vtk,flow,,28,1,1,1,10,1,1,1,0,0,1
  wrnd                               ! see above
next                                 ! go to next
end                                  ! end of loop


END RUN_CONTROL




