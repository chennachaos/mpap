MPAP2

%===================================================================================================

BEGIN HBSPLINECUTFEM 1


dimensions
! ndf ndm
  3   2


origin
!  X0   Y0   Z0
  0.0  0.0  0.0


grid dimensions
! lx     ly    lz
  10.0   30.0    1.0


polynomial degrees
!  p   q   r
   2   2   0


number of elements
!  nx   ny   nz
  21   61   0


fluid properties
! nGP flag  axsy     rho      mu1   mu2   fx   fy   tauSUPG  tauPSPG  tauLSIC     eps     gamm
   3    5    0       1.0      0.1   0.0   0.0  0.0    0.0      1.0       0.0       0.0    0.0


refinement type
! type nref
   5    0    1


mesh refinement limits
 1  1.0    9.0     2.0     8.0
 1  1.0    9.0     16.0    23.0
 2  8.9    10.9    12.0    17.8
 3  9.1    10.75   12.1    17.7
 4  9.3    10.65   12.5    17.4



dirichlet boundary conditions
! side  dir  PEN   Flag Factor  proftype  val   ll   ul
   1    1   1.0e2   1   -1.0       1      0.0  0.0  0.0
   2    1   1.0e2   1   -1.0       1      0.0  0.0  0.0
   4    1   1.0e2   1   -1.0       1      0.0  0.0  0.0
   4    2   1.0e2   1   -1.0       1     -1.0  0.0  0.0


staggered or monolithic
0  2  0.1


cutfem parameters
! gp_type  nGPbound  nGPcell  refLev1   refLev2  tmp2  gammU   gammP
    1         5         7        5          0     1     0.00   0.00


immersed body data
! R/F  P/L  penalty  Nitsche  NitscheFact
   0    0   1.0e2     -1        1.0


immersed points
    1 	   2.00000000 	   3.00000000 
    2 	   2.40000000 	   3.00000000 
    3 	   2.80000000 	   3.00000000 
    4 	   3.20000000 	   3.00000000 
    5 	   3.60000000 	   3.00000000 
    6 	   4.00000000 	   3.00000000 
    7 	   4.40000000 	   3.00000000 
    8 	   4.80000000 	   3.00000000 
    9 	   5.20000000 	   3.00000000 
   10 	   5.60000000 	   3.00000000 
   11 	   6.00000000 	   3.00000000 
   12 	   6.40000000 	   3.00000000 
   13 	   6.80000000 	   3.00000000 
   14 	   7.20000000 	   3.00000000 
   15 	   7.60000000 	   3.00000000 
   16 	   8.00000000 	   3.00000000 
   17 	   8.00000000 	   3.26666667 
   18 	   8.00000000 	   3.53333333 
   19 	   8.00000000 	   3.80000000 
   20 	   8.00000000 	   4.06666667 
   21 	   8.00000000 	   4.33333333 
   22 	   8.00000000 	   4.60000000 
   23 	   8.00000000 	   4.86666667 
   24 	   8.00000000 	   5.13333333 
   25 	   8.00000000 	   5.40000000 
   26 	   8.00000000 	   5.66666667 
   27 	   8.00000000 	   5.93333333 
   28 	   8.00000000 	   6.20000000 
   29 	   8.00000000 	   6.46666667 
   30 	   8.00000000 	   6.73333333 
   31 	   8.00000000 	   7.00000000 
   32 	   7.60000000 	   7.00000000 
   33 	   7.20000000 	   7.00000000 
   34 	   6.80000000 	   7.00000000 
   35 	   6.40000000 	   7.00000000 
   36 	   6.00000000 	   7.00000000 
   37 	   5.60000000 	   7.00000000 
   38 	   5.20000000 	   7.00000000 
   39 	   4.80000000 	   7.00000000 
   40 	   4.40000000 	   7.00000000 
   41 	   4.00000000 	   7.00000000 
   42 	   3.60000000 	   7.00000000 
   43 	   3.20000000 	   7.00000000 
   44 	   2.80000000 	   7.00000000 
   45 	   2.40000000 	   7.00000000 
   46 	   2.00000000 	   7.00000000 
   47 	   2.00000000 	   6.73333333 
   48 	   2.00000000 	   6.46666667 
   49 	   2.00000000 	   6.20000000 
   50 	   2.00000000 	   5.93333333 
   51 	   2.00000000 	   5.66666667 
   52 	   2.00000000 	   5.40000000 
   53 	   2.00000000 	   5.13333333 
   54 	   2.00000000 	   4.86666667 
   55 	   2.00000000 	   4.60000000 
   56 	   2.00000000 	   4.33333333 
   57 	   2.00000000 	   4.06666667 
   58 	   2.00000000 	   3.80000000 
   59 	   2.00000000 	   3.53333333 
   60 	   2.00000000 	   3.26666667 


immersed integration elements
1	1	1	2
2	1	2	3
3	1	3	4
4	1	4	5
5	1	5	6
6	1	6	7
7	1	7	8
8	1	8	9
9	1	9	10
10	1	10	11
11	1	11	12
12	1	12	13
13	1	13	14
14	1	14	15
15	1	15	16
16	1	16	17
17	1	17	18
18	1	18	19
19	1	19	20
20	1	20	21
21	1	21	22
22	1	22	23
23	1	23	24
24	1	24	25
25	1	25	26
26	1	26	27
27	1	27	28
28	1	28	29
29	1	29	30
30	1	30	31
31	1	31	32
32	1	32	33
33	1	33	34
34	1	34	35
35	1	35	36
36	1	36	37
37	1	37	38
38	1	38	39
39	1	39	40
40	1	40	41
41	1	41	42
42	1	42	43
43	1	43	44
44	1	44	45
45	1	45	46
46	1	46	47
47	1	47	48
48	1	48	49
49	1	49	50
50	1	50	51
51	1	51	52
52	1	52	53
53	1	53	54
54	1	54	55
55	1	55	56
56	1	56	57
57	1	57	58
58	1	58	59
59	1	59	60
60	1	60	1



immersed body data
! R/F  P/L  penalty  Nitsche  NitscheFact
   0    1    1.0e2     -1        1.0


immersed points
1	2.00000000	14.00000000
2	2.40000000	14.00000000
3	2.80000000	14.00000000
4	3.20000000	14.00000000
5	3.60000000	14.00000000
6	4.00000000	14.00000000
7	4.40000000	14.00000000
8	4.80000000	14.00000000
9	5.20000000	14.00000000
10	5.60000000	14.00000000
11	6.00000000	14.00000000
12	6.40000000	14.00000000
13	6.80000000	14.00000000
14	7.20000000	14.00000000
15	7.60000000	14.00000000
16	8.00000000	14.00000000
17	8.00000000	14.26666667
18	8.00000000	14.53333333
19	8.00000000	14.80000000
20	8.00000000	15.06666667
21	8.00000000	15.33333333
22	8.00000000	15.60000000
23	8.00000000	15.86666667
24	8.00000000	16.13333333
25	8.00000000	16.40000000
26	8.00000000	16.66666667
27	8.00000000	16.93333333
28	8.00000000	17.20000000
29	8.00000000	17.46666667
30	8.00000000	17.73333333
31	8.00000000	18.00000000
32	7.60000000	18.00000000
33	7.20000000	18.00000000
34	6.80000000	18.00000000
35	6.40000000	18.00000000
36	6.00000000	18.00000000
37	5.60000000	18.00000000
38	5.20000000	18.00000000
39	4.80000000	18.00000000
40	4.40000000	18.00000000
41	4.00000000	18.00000000
42	3.60000000	18.00000000
43	3.20000000	18.00000000
44	2.80000000	18.00000000
45	2.40000000	18.00000000
46	2.00000000	18.00000000
47	2.00000000	17.73333333
48	2.00000000	17.46666667
49	2.00000000	17.20000000
50	2.00000000	16.93333333
51	2.00000000	16.66666667
52	2.00000000	16.40000000
53	2.00000000	16.13333333
54	2.00000000	15.86666667
55	2.00000000	15.60000000
56	2.00000000	15.33333333
57	2.00000000	15.06666667
58	2.00000000	14.80000000
59	2.00000000	14.53333333
60	2.00000000	14.26666667



immersed integration elements
1	1	1	2
2	1	2	3
3	1	3	4
4	1	4	5
5	1	5	6
6	1	6	7
7	1	7	8
8	1	8	9
9	1	9	10
10	1	10	11
11	1	11	12
12	1	12	13
13	1	13	14
14	1	14	15
15	1	15	16
16	1	16	17
17	1	17	18
18	1	18	19
19	1	19	20
20	1	20	21
21	1	21	22
22	1	22	23
23	1	23	24
24	1	24	25
25	1	25	26
26	1	26	27
27	1	27	28
28	1	28	29
29	1	29	30
30	1	30	31
31	1	31	32
32	1	32	33
33	1	33	34
34	1	34	35
35	1	35	36
36	1	36	37
37	1	37	38
38	1	38	39
39	1	39	40
40	1	40	41
41	1	41	42
42	1	42	43
43	1	43	44
44	1	44	45
45	1	45	46
46	1	46	47
47	1	47	48
48	1	48	49
49	1	49	50
50	1	50	51
51	1	51	52
52	1	52	53
53	1	53	54
54	1	54	55
55	1	55	56
56	1	56	57
57	1	57	58
58	1	58	59
59	1	59	60
60	1	60	1



immersed body data
! R/F  P/L  penalty  Nitsche  NitscheFact
   0    1    1.0e2     -1        1.0


immersed points
1	6.50000000	25.00000000
2	6.48057539	25.24061692
3	6.42280466	25.47500199
4	6.32818404	25.69708476
5	6.19916415	25.90111340
6	6.03908653	26.08180367
7	5.85209712	26.23447580
8	5.64303884	26.35517565
9	5.41732620	26.44077717
10	5.18080502	26.48906331
11	4.93960109	26.49878350
12	4.69996146	26.46968598
13	4.46809267	26.40252436
14	4.25000000	26.29903811
15	4.05133194	26.16190744
16	3.87723388	25.99468399
17	3.73221487	25.80169874
18	3.62003083	25.58794991
19	3.54358727	25.35897350
20	3.50486404	25.12069985
21	3.50486404	24.87930015
22	3.54358727	24.64102650
23	3.62003083	24.41205009
24	3.73221487	24.19830126
25	3.87723388	24.00531601
26	4.05133194	23.83809256
27	4.25000000	23.70096189
28	4.46809267	23.59747564
29	4.69996146	23.53031402
30	4.93960109	23.50121650
31	5.18080502	23.51093669
32	5.41732620	23.55922283
33	5.64303884	23.64482435
34	5.85209712	23.76552420
35	6.03908653	23.91819633
36	6.19916415	24.09888660
37	6.32818404	24.30291524
38	6.42280466	24.52499801
39	6.48057539	24.75938308


immersed integration elements
1	1	1	2
2	1	2	3
3	1	3	4
4	1	4	5
5	1	5	6
6	1	6	7
7	1	7	8
8	1	8	9
9	1	9	10
10	1	10	11
11	1	11	12
12	1	12	13
13	1	13	14
14	1	14	15
15	1	15	16
16	1	16	17
17	1	17	18
18	1	18	19
19	1	19	20
20	1	20	21
21	1	21	22
22	1	22	23
23	1	23	24
24	1	24	25
25	1	25	26
26	1	26	27
27	1	27	28
28	1	28	29
29	1	29	30
30	1	30	31
31	1	31	32
32	1	32	33
33	1	33	34
34	1	34	35
35	1	35	36
36	1	36	37
37	1	37	38
38	1	38	39
39	1	39	1



control parameters
! tol      tis   tis_param
  1.0e-6    0      0.0



END HBSPLINECUTFEM 1



BEGIN TIME_FUNCTIONS
!
! lam(t) = p1 + p2*t + p3*sin(p4*t+p5) + p6*cos(p7*t+p8)
!
! id  t0    t1     p1    p2    p3    p4    p5
!  1  0.0  10000.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0

  1  0.0      1.0   0.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0
  1  1.0  10000.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0


END TIME_FUNCTIONS

%===================================================================================================



BEGIN RUN_CONTROL



BATCH
anly,solv,,28,1,8,3,1,1,1                    ! this sets the solver
chen,data,,28,2,2,2,1                        ! this generates the grid file, without any solution field.
!vtk,flow,,28,1,1,1,1,1,1,1,0,0,1            ! this generates the grid file, with the solution field. Since we have not solved anything, all the values are zero.
dt,,0.1                                      ! time step size
wrnd                                         ! write nodal data to the output file starting with T
!wait,mous                                   ! useful to stop the program before running the time loop if we want to check if the input geometries are correct.
loop,,1.99999999,2                           ! Time loop; this particular one runs up to a final time of 10 seconds. Set 9.999999999 to avoid floating point issues.
  time                                       ! update time functions
  !chen,fsi,,28,1,1,2,1                      ! FSI coupling loop with two coupling iterations
  chen,fsi,,28,1,1,1,1                       ! FSI coupling loop with one coupling iteration
  prnt                                       
    !vtk,flow,,28,1,1,1,10,1,1,1,0,0,1       ! generates output in the VTK format. One for each time step. To generate one file for every 10th step use vtk,flow,,28,1,1,1,10,1,1,1,0,0,1
    vtk,flow,,28,1,1,1,1,1,1,1,0,0,1
    wrnd
    dt,stck                                  ! time step control if not converged
next                                 ! go to next
end                                  ! end of loop





END RUN_CONTROL




