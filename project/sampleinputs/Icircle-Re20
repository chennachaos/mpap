MPAP2

%===================================================================================================

BEGIN HBSPLINECUTFEM 1


dimensions
! ndf ndm
  3   2


origin
!  X0   Y0   Z0
  0.0  5.0  0.0


grid dimensions
! lx     ly    lz
  30.0   20.0    1.0


polynomial degrees
!  p   q   r
   1   1   0
!   2   2   0
!   3   3   0


number of elements
!  nx   ny   nz
  81   61   0


fluid properties
! nGP flag  axsy     rho      mu    fx    fy    fz    tauSUPG      tauPSPG  tauLSIC     eps     gamm
   2    0    0       1.0     0.05   0.0   0.0  0.0      1.0         1.0       0.0       0.0    0.0


refinement type
! type nref
   5    3    1


mesh refinement limits
! 1  6.5    25.0    11.5    18.3
! 2  7.5    20.0    12.5    17.5
! 3  8.5    14.0    12.8    17.2
! 4  9.3    10.65   12.5    17.4


 1  6.5    14.0    11.5    18.3
 2  7.5    13.0    12.5    17.5
 3  8.5    12.0    12.8    17.2
 4  9.3    10.65   12.5    17.4


dirichlet boundary conditions
! side  dir  PEN   Flag Factor  proftype  val   ll   ul
   1    1   1.0e2   1   -1.0       1      1.0  0.0  0.0
   1    2   1.0e2   1   -1.0       1      0.0  0.0  0.0
   3    2   1.0e2   1   -1.0       1      0.0  0.0  0.0
   4    2   1.0e2   1   -1.0       1      0.0  0.0  0.0


staggered or monolithic
0  2  0.9  0.0  0.0


cutfem parameters
! gp_type  nGPbound  nGPcell  refLev1   refLev2  tmp2  gammU    gammP
    1         5         3        1         0      1     0.02    0.02



immersed body data
! R/F  P/L  penalty  Nitsche  NitscheFact
   0    0    1.0e2      1      -1.0


immersed points
1	10.50000000	15.10000000
2	10.49841942	15.06027492
3	10.49368767	15.02080099
4	10.48583467	14.98182778
5	10.47491007	14.94360170
6	10.46098293	14.90636441
7	10.44414131	14.87035136
8	10.42449168	14.83579021
9	10.40215828	14.80289949
10	10.37728231	14.77188713
11	10.35002104	14.74294920
12	10.32054682	14.71626867
13	10.28904600	14.69201420
14	10.25571774	14.67033916
15	10.22077275	14.65138057
16	10.18443196	14.63525830
17	10.14692514	14.62207427
18	10.10848940	14.61191184
19	10.06936777	14.60483527
20	10.02980756	14.60088928
21	9.99005891	14.60009884
22	9.95037310	14.60246892
23	9.91100105	14.60798457
24	9.87219168	14.61661089
25	9.83419036	14.62829335
26	9.79723734	14.64295809
27	9.76156625	14.66051240
28	9.72740261	14.68084530
29	9.69496243	14.70382822
30	9.66445079	14.72931587
31	9.63606059	14.75714710
32	9.60997135	14.78714596
33	9.58634798	14.81912279
34	9.56533986	14.85287541
35	9.54707980	14.88819043
36	9.53168325	14.92484458
37	9.51924755	14.96260611
38	9.50985132	15.00123630
39	9.50355396	15.04049090
40	9.50039530	15.08012174
41	9.50039530	15.11987826
42	9.50355396	15.15950910
43	9.50985132	15.19876370
44	9.51924755	15.23739389
45	9.53168325	15.27515542
46	9.54707980	15.31180957
47	9.56533986	15.34712459
48	9.58634798	15.38087721
49	9.60997135	15.41285404
50	9.63606059	15.44285290
51	9.66445079	15.47068413
52	9.69496243	15.49617178
53	9.72740261	15.51915470
54	9.76156625	15.53948760
55	9.79723734	15.55704191
56	9.83419036	15.57170665
57	9.87219168	15.58338911
58	9.91100105	15.59201543
59	9.95037310	15.59753108
60	9.99005891	15.59990116
61	10.02980756	15.59911072
62	10.06936777	15.59516473
63	10.10848940	15.58808816
64	10.14692514	15.57792573
65	10.18443196	15.56474170
66	10.22077275	15.54861943
67	10.25571774	15.52966084
68	10.28904600	15.50798580
69	10.32054682	15.48373133
70	10.35002104	15.45705080
71	10.37728231	15.42811287
72	10.40215828	15.39710051
73	10.42449168	15.36420979
74	10.44414131	15.32964864
75	10.46098293	15.29363559
76	10.47491007	15.25639830
77	10.48583467	15.21817222
78	10.49368767	15.17919901
79	10.49841942	15.13972508



immersed integration elements
1	1	1	2
2	1	2	3
3	1	3	4
4	1	4	5
5	1	5	6
6	1	6	7
7	1	7	8
8	1	8	9
9	1	9	10
10	1	10	11
11	1	11	12
12	1	12	13
13	1	13	14
14	1	14	15
15	1	15	16
16	1	16	17
17	1	17	18
18	1	18	19
19	1	19	20
20	1	20	21
21	1	21	22
22	1	22	23
23	1	23	24
24	1	24	25
25	1	25	26
26	1	26	27
27	1	27	28
28	1	28	29
29	1	29	30
30	1	30	31
31	1	31	32
32	1	32	33
33	1	33	34
34	1	34	35
35	1	35	36
36	1	36	37
37	1	37	38
38	1	38	39
39	1	39	40
40	1	40	41
41	1	41	42
42	1	42	43
43	1	43	44
44	1	44	45
45	1	45	46
46	1	46	47
47	1	47	48
48	1	48	49
49	1	49	50
50	1	50	51
51	1	51	52
52	1	52	53
53	1	53	54
54	1	54	55
55	1	55	56
56	1	56	57
57	1	57	58
58	1	58	59
59	1	59	60
60	1	60	61
61	1	61	62
62	1	62	63
63	1	63	64
64	1	64	65
65	1	65	66
66	1	66	67
67	1	67	68
68	1	68	69
69	1	69	70
70	1	70	71
71	1	71	72
72	1	72	73
73	1	73	74
74	1	74	75
75	1	75	76
76	1	76	77
77	1	77	78
78	1	78	79
79	1	79	1


rigid body mass
!   Mxx   Mxy  Mxt  Myx   Myy   Myt  Mtx  Mty  Mtt
  117.10  0.0  0.0  0.0  117.10  0.0  0.0  0.0  0.0


rigid body damping
!   Cxx    Cxy  Cxt  Cyx    Cyy    Cyt  Ctx  Cty  Ctt
  0.35317  0.0  0.0  0.0  0.35317  0.0  0.0  0.0  0.0


rigid body stiffness
! Kxx   Kxy  Kxt  Kyx    Kyy    Kyt  Ktx  Kty  Ktt
 184.92  0.0  0.0  0.0  184.92  0.0  0.0  0.0  0.0


rigid body degree of freedom
! d1   d2   d3
 -1    -1   -1  


immersed body output
! type  nodenum  dof
   1       1      1 
   1       1      2 
   3       1      1 
   3       1      2 
   4       1      1 
   4       1      2 
   5       1      1 
   5       1      2 


control parameters
!  tol     tis   tis_param
 1.0e-6     0      0.0




END HBSPLINECUTFEM 1



BEGIN TIME_FUNCTIONS
!
! lam(t) = p1 + p2*t + p3*sin(p4*t+p5) + p6*cos(p7*t+p8)
!
! id  t0    t1      p1    p2    p3    p4    p5     p6   p7    p8

!  1  0.0  10000.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0

  1  0.0      1.0   0.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0
  1  1.0  10000.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0



END TIME_FUNCTIONS

%===================================================================================================



BEGIN RUN_CONTROL



BATCH
anly,solv,,28,1,8,3,1,1,1                    ! this sets the solver
chen,data,,28,2,2,2,1                        ! this generates the grid file, without any solution field.
!vtk,flow,,28,1,1,1,1,1,1,1,0,0,1            ! this generates the grid file, with the solution field. Since we have not solved anything, all the values are zero.
dt,,0.2                                      ! time step size
wrnd                                         ! write nodal data to the output file starting with T
!wait,mous                                   ! useful to stop the program before running the time loop if we want to check if the input geometries are correct.
loop,,1.99999999,2                           ! Time loop; this particular one runs up to a final time of 10 seconds. Set 9.999999999 to avoid floating point issues.
  time                                       ! update time functions
  !chen,fsi,,28,1,1,2,1                      ! FSI coupling loop with two coupling iterations
  chen,fsi,,28,1,1,1,1                       ! FSI coupling loop with one coupling iteration
  prnt                                       
    !vtk,flow,,28,1,1,1,10,1,1,1,0,0,1       ! generates output in the VTK format. One for each time step. To generate one file for every 10th step use vtk,flow,,28,1,1,1,10,1,1,1,0,0,1
    vtk,flow,,28,1,1,1,1,1,1,1,0,0,1
    wrnd
    dt,stck                                  ! time step control if not converged
next                                         ! go to next
end                                          ! end of loop





END RUN_CONTROL




